"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("jquery"),require("handlebars")):"function"==typeof define&&define.amd?define(["jquery","handlebars"],t):t(e.jQuery,e.window)}(window,function(f,h){f=f&&f.hasOwnProperty("default")?f.default:f;var r=function(e){if(e)for(var t=e.lastChild;t;){var l=t.previousSibling;e.removeChild(t),t=l}};f.fn.checklist=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];if("string"==typeof t[0]){var i=u[t[0]];if("function"==typeof i)return i.apply(this,Array.prototype.slice.call(t,1));console.error(t[0]+" is not a function.")}else n.apply(this,t)},f.checklist={defaultTemplate:'<div class="ckl-container">\n\t{{#if opts.actionsBox}}\n\t<div ckl-actions>\n\t\t{{#if multiple}}\n\t\t<button type="button" ckl-select-all class="btn btn-default" {{#if disabled}}disabled{{/if}}>{{opts.selectAllText}}</button>\n\t\t{{/if}}\n\t\t<button type="button" ckl-deselect-all class="btn btn-default" {{#if disabled}}disabled{{/if}}>{{#if multiple}}{{opts.deselectAllText}}{{else}}{{opts.deselectText}}{{/if}}</button>\n\t</div>\n\t{{/if}}\n\t<ul>\n\t\t{{#each items}}\n\t\t<li ckl-item>\n\t\t\t<input ckl-input value="{{value}}" name="{{../inputName}}" type="{{../inputType}}" {{#if ../disabled}}disabled{{/if}} {{#if _chklst_selected}}checked{{/if}}/>\n\t\t\t{{text}}\n\t\t</li>\n\t\t{{/each}}\n\t</ul>\n\t</div>'};var o=0,n=function(r){this.each(function(e,t){var l=f.extend({template:f.checklist.defaultTemplate,selectAllText:"Select All",deselectAllText:"Deselect All",deselectText:"Deselect"},r),i=f(t),n=i.prop("multiple"),c=i.attr("name")||"_ckl_"+o;i.removeAttr("name").hide(),o++;var a={opts:l,multiple:n,inputType:n?"checkbox":"radio",inputName:c,disabled:i.prop("disabled")};t._ckl_ctx=a,u.refresh.call(i)})},u={selectAll:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("checked",!0):f(t).prop("multiple")&&f(t).find("option").prop("selected",!0)}),this},deselectAll:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("checked",!1):f(t).find("option").prop("selected",!1)}),this},disable:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("disabled",!0):f(t).prop("disabled",!0)}),this},enable:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("disabled",!1):f(t).prop("disabled",!1)}),this},getValue:function(){var e=this[0];if(e)return e._ckl_ctx&&e._ckl_ctx.$ele?e._ckl_ctx.$ele.inputVal()[e._ckl_ctx.inputName]:this.val()},setValue:function(a){return this.each(function(e,t){if(r(t),!Array.isArray(a)){var l=a;a=[],null!=l&&a.push(l)}for(var i=0;i<a.length;i++){var n=document.createElement("option");n.setAttribute("value",a[i]),n.setAttribute("selected","selected"),t.appendChild(n)}if(f(t).val(a),t._ckl_ctx&&t._ckl_ctx.$ele){var c={};c[t._ckl_ctx.inputName]=a,t._ckl_ctx.$ele.inputVal(c)}}),this},refresh:function(){return Promise.all(this.map(function(e,t){var u=f(t),s=t._ckl_ctx;if(!s)return Promise.resolve();var p=l(t),d=s.opts;return s.$ele&&(s.$ele.remove(),s.$ele=void 0),(d.hasOwnProperty("ajax")?"function"==typeof d.ajax?d.ajax():new Promise(function(e,t){f.ajax(d.ajax).done(e).fail(t)}):Promise.resolve(u.find("option").map(function(e,t){var l=f(t);return{value:l.attr("value"),text:l.text()}}).toArray())).then(function(e){e||(e=[]);var t=!0,l=!1,i=void 0;try{for(var n,c=e[Symbol.iterator]();!(t=(n=c.next()).done);t=!0){var a=n.value;a._chklst_selected=-1<p.indexOf(""+a.value)}}catch(e){l=!0,i=e}finally{try{!t&&c.return&&c.return()}finally{if(l)throw i}}s.items=e;var r=h.Handlebars.compile(d.template)(s),o=f(r);u.after(o),(s.$ele=o).find("[ckl-select-all]").click(function(){o.find("input:radio,input:checkbox").prop("checked",!0)}),o.find("[ckl-deselect-all]").click(function(){o.find("input:radio,input:checkbox").prop("checked",!1)})})}))}},l=function(e){var t=u.getValue.call(f(e));return f(e).prop("multiple")||(t=null==t?[]:[t]),t}});
