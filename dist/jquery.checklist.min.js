"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("jquery"),require("handlebars")):"function"==typeof define&&define.amd?define(["jquery","handlebars"],t):t(e.jQuery,e.window)}(window,function(f,h){(f=f&&f.hasOwnProperty("default")?f.default:f).fn.checklist=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];if("string"==typeof t[0]){var n=u[t[0]];if("function"==typeof n)return n.apply(this,Array.prototype.slice.call(t,1));console.error(t[0]+" is not a function.")}else i.apply(this,t)},f.checklist={defaultTemplate:'<div class="ckl-container">\n\t{{#if opts.actionsBox}}\n\t<div ckl-actions>\n\t\t{{#if multiple}}\n\t\t<button type="button" ckl-select-all class="btn btn-default" {{#if disabled}}disabled{{/if}}>{{opts.selectAllText}}</button>\n\t\t{{/if}}\n\t\t<button type="button" ckl-deselect-all class="btn btn-default" {{#if disabled}}disabled{{/if}}>{{#if multiple}}{{opts.deselectAllText}}{{else}}{{opts.deselectText}}{{/if}}</button>\n\t</div>\n\t{{/if}}\n\t<ul>\n\t\t{{#each items}}\n\t\t<li ckl-item>\n\t\t\t<input ckl-input value="{{value}}" name="{{../inputName}}" type="{{../inputType}}" {{#if ../disabled}}disabled{{/if}}/>\n\t\t\t{{text}}\n\t\t</li>\n\t\t{{/each}}\n\t</ul>\n\t</div>'};var r=0,i=function(o){this.each(function(e,t){var l=f.extend({template:f.checklist.defaultTemplate,selectAllText:"Select All",deselectAllText:"Deselect All",deselectText:"Deselect"},o),n=f(t),i=n.prop("multiple"),c=n.attr("name")||"_ckl_"+r;n.removeAttr("name").hide(),r++;var a={opts:l,multiple:i,inputType:i?"checkbox":"radio",inputName:c,disabled:n.prop("disabled")};t._ckl_ctx=a,u.refresh.call(n)})},u={selectAll:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("checked",!0):f(t).prop("multiple")&&f(t).find("option").prop("selected",!0)}),this},deselectAll:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("checked",!1):f(t).find("option").prop("selected",!1)}),this},disable:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("disabled",!0):f(t).prop("disabled",!0)}),this},enable:function(){return this.each(function(e,t){t._ckl_ctx&&t._ckl_ctx.$ele?t._ckl_ctx.$ele.find("input:radio,input:checkbox").prop("disabled",!1):f(t).prop("disabled",!1)}),this},getValue:function(){var e=this[0];if(e)return e._ckl_ctx&&e._ckl_ctx.$ele?e._ckl_ctx.$ele.inputVal()[e._ckl_ctx.inputName]:this.val()},setValue:function(n){return this.each(function(e,t){if(t._ckl_ctx&&t._ckl_ctx.$ele){var l={};l[t._ckl_ctx.inputName]=n,t._ckl_ctx.$ele.inputVal(l)}else f(t).val(n)}),this},refresh:function(){return Promise.all(this.map(function(e,t){var u=f(t),p=t._ckl_ctx;if(!p)return Promise.resolve();var s=l(t),d=p.opts;return p.$ele&&(p.$ele.remove(),p.$ele=void 0),(d.hasOwnProperty("ajax")?"function"==typeof d.ajax?d.ajax():new Promise(function(e,t){f.ajax(d.ajax).done(e).fail(t)}):Promise.resolve(u.find("option").map(function(e,t){var l=f(t);return{value:l.attr("value"),text:l.text()}}).toArray())).then(function(e){e||(e=[]);var t=!0,l=!1,n=void 0;try{for(var i,c=e[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){var a=i.value;a._chklst_selected=-1<s.indexOf(""+a.value)}}catch(e){l=!0,n=e}finally{try{!t&&c.return&&c.return()}finally{if(l)throw n}}p.items=e;var o=h.Handlebars.compile(d.template)(p),r=f(o);u.after(r),(p.$ele=r).find("[ckl-select-all]").click(function(){r.find("input:radio,input:checkbox").prop("checked",!0)}),r.find("[ckl-deselect-all]").click(function(){r.find("input:radio,input:checkbox").prop("checked",!1)})})}))}},l=function(e){var t=u.getValue.call(f(e));return f(e).prop("multiple")||(t=null==t?[]:[t]),t}});
